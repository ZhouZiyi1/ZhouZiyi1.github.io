(function(){var e="2311281800",t=3e3,n=7e3,r=5120,o=100,i=window.location,a=!!i.href.match(/192\.168|localhost|172\.20|127\.0\.0\.1/gi),s=new RegExp(".*(((kakamobi|mucang|jiakaobaodian|jiaxiaozhijia|xiaozhu2|pingxing|jiaxiaobang|tufu|baodianjiaoyu|gongkaobaodian|jiakaogongju|jiakaoxinxi|kaozhengbaodian|baodian|mc-cdn|futurephantom).(com|cn|net)))","gi"),c=i.href.replace(/(\?|#).*/gi,"").replace(/.*\/\//gi,""),d=(c.slice(0,c.lastIndexOf("/")+1)||"").replace(/\/+$/gi,""),u=window.navigator.userAgent||"",p=!!(u.toLowerCase().match(/mucang/g)||window.MCProtocolIosExecute||window.getMucangIOSWebViewData)&&!u.toLowerCase().match(/\.mucang\./g),l=["transfersize","decodedbodysize","encodedbodysize"],g=function(){var n,r=this,o=0;window.MCPerfV=e,r.reset(),r.isVue=!1,r.isNode=!1,n=function(){if(r.isListening||!r.isVue)return clearTimeout(r.readyTimer),!1;r.isListening=!0,clearTimeout(r.readyTimer),r.readyTimer=setTimeout(function(){r.reset(),r.init("ready"),setTimeout(function(){r.init("timeout")},t),r.isListening=!1},1e3)},document.addEventListener("readystatechange",function(e){var i,a;"interactive"!==document.readyState&&"complete"!==document.readyState||o++,1===o&&(i=document.body&&document.body.innerHTML||"",a=document.head&&document.head.innerHTML||"",r.isVue=!!i.match(/chunk-.*\.js/gi)||!!a.match(/paas/)||!!a.match(/.vue.*?.js/),r.isNode=!!i.match(/Simple.node\=true/gi),r.init("ready"),setTimeout(function(){r.init("timeout")},t),r.observer(),r.isVue&&(history.pushState=r.his("pushState"),window.addEventListener("pushState",function(){n()})))}),window.addEventListener("hashchange",function(){n()})},m=function(){a||this.init()};g.prototype.format=function(e){return parseInt((e||0).toFixed(0))},g.prototype.reset=function(){var e=this;e.resAllLen=0,e.pageReportedIdx=0,e.allRess=[],e.readyTimer=e.obsTimer=null,window.performance.clearResourceTimings()},g.prototype.his=function(e){try{var t=history[e];return function(){var n=new Event(e);return n.arguments=arguments,window.dispatchEvent(n),t.apply(this,arguments)}}catch(e){console.log(e)}},g.prototype.observer=function(){var e=this;if(e.Observer)return!1;e.obsTimer=null,e.allRess=e.allRess||[];try{e.Observer=new PerformanceObserver(function(r){var o=r.getEntriesByType("resource")||[];e.allRess=e.allRess.concat(o),clearTimeout(e.obsTimer),e.obsTimer=setTimeout(function(){e.init("report")},t+n)}),e.Observer.observe({entryTypes:["resource"]}),window.performance.addEventListener("resourcetimingbufferfull",function(){window.performance.clearResourceTimings(),e.resAllLen=0,e.allRess=[]})}catch(e){console.warn("PerformanceObserver not support")}},g.prototype.init=function(o){var u,p,g,m,f,h,w,y=this,v={strs:{},numbers:{}},b={},C="ready"===o,I="report"===o,x="timeout"===o,O=x||I,S=[],A=[],_=!1,T=!1,L="index.html",R=["domContentLoadedEventEnd","loadEventEnd"];if(a)return!1;I&&(o="timeout");try{if(u=y.pageReportedIdx<2?window.performance.getEntriesByType("navigation"):[],b=u&&u[0]||{},p=C?[]:y.allRess,v.strs.id=d,v.strs.page=y.isVue?i.href.replace(/\?.*\#/gi,"#").replace(/.*\/\/|\?.*/gi,""):c,v.strs.v=e,y.isNode&&(L="/",v.strs.id=i.host||"",v.strs.page=(i.pathname||"").replace(/\/$/gi,"")),w=new RegExp(d,"ig"),v.strs.page=(v.strs.page||"").replace(w,"").replace(/^\//gi,"")||L,v.strs.localCached=y.checkCache(d,(c||"").replace(w,"")||L),!I)for(h in b)if("number"==typeof b[h]&&-1===l.indexOf(h.toLowerCase())){var E=0;T=!0,x&&-1!==R.indexOf(h)&&!b[h]&&(E=t+1),v.numbers["page_"+h]=y.format(b[h]||E)}if(O&&p&&p.length){var P,j=p.length,N=[];for(N=p.slice(y.resAllLen,p.length),y.resApiOpen&&y.resApiOpen.length&&(N=N.concat(y.resApiOpen),y.resApiOpenIds=[],y.resApiOpen=[]),g=0,m=N.length;g<m;g++){var M,U,k,J=new RegExp("favicon\\.ico|oort-shipper\\.|perf.*\\.js|api/paas/core/comet/notice.htm|.*\\.htm","gi");f=N[g]||{},M=f.name||"",k=y.format(f.duration||t+n+1),U=encodeURIComponent(M.match(/\?/gi)?M.replace(/.*\?/gi,""):""),M=M.replace(/.*\/\//gi,"").replace(/(\?|#).*/gi,""),M&&"resource"===f.entryType&&!M.match(J)&&M.match(s)&&k>0&&(y.resAllLen=j,S.push(M),A.push(k),M.match(/\.htm/gi)&&(P=P||{},P[M]=P[M]||[],U&&-1===P[M].indexOf(U)&&P[M].push(U.length>r?U.slice(0,r)+"...":U)))}S.length&&(_=!0,v.strs.res=JSON.stringify(S),v.strs.resTime=JSON.stringify(A),v.strs.resParam=P?JSON.stringify(P):"")}(_||T)&&(y.pageReportedIdx++,y.send(v,o))}catch(e){console.log(e)}return null},g.prototype.checkCache=function(e,t){var n,r,o,i,a=+new Date,s=!1,c=(e||"").replace(/\//gi,"-").replace(/\./gi,"_").replace(/\:/gi,"__"),d=this.clearCache(c);return this.isCached=this.isCached||null,e&&t&&null===this.isCached&&(r=performance.getEntriesByType("navigation")[0]||{},o=r.transferSize,i=r.encodedBodySize,n=JSON.parse(localStorage.getItem(c)||"{}"),n[t]=parseInt(n[t]||"0"),!o&&0!==o||!i&&0!==i||(n[t+"_body"]&&n[t+"_body"]===i||(s=!0),s?(this.isCached=!1,n[t+"_body"]=i,d&&(n.time=a),localStorage.setItem(c,JSON.stringify(n))):(this.isCached=n[t]&&o<n[t]/2,n[t]&&this.isCached||(n[t]=o,d&&(n.time=a),localStorage.setItem(c,JSON.stringify(n)))))),this.isCached?"true":"false"},g.prototype.clearCache=function(e){var t,n,r,o=+new Date,i=6048e5,a=!1;try{if(e&&(t=JSON.parse(localStorage.getItem(e)||"{}"),n=t.time||"",!n||o-n>i))for(r in a=!0,localStorage)r&&r.match(/_kakamobi_com-|_jiakaobaodian_com-|_mucang_cn-/gi)&&localStorage.removeItem(r)}catch(e){console.log(e)}return a},g.prototype.pageChange=function(){console.warn("MCPerf pageChange event listener is no needed any more")},g.prototype.getURLParams=function(e){var t={};return i.href.replace(/[#|?&]+([^=#|&]+)=([^#|&]*)/gi,function(n,r,o){"null"!==o&&"(null)"!==o&&"undefined"!==o||(o=""),t[r]=decodeURIComponent(o),e&&r&&-1===r.indexOf(e)&&delete t[r]}),t},g.prototype.getPlatform=function(){var e="";return e=-1!==window.navigator.userAgent.indexOf("Android")?"Android":-1!==window.navigator.userAgent.indexOf("iPhone")?"iPhone":-1!==window.navigator.userAgent.indexOf("Windows")?"Windows":-1!==window.navigator.userAgent.indexOf("iPad")?"iPad":"Other",e.toLocaleLowerCase()},g.prototype.genUId=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},g.prototype.setAppUser=function(e){var t=this.getURLParams("_")||{},n=t[e]||"",r=["MCH5Perf",e].join("_"),o=window.localStorage.getItem(r);return o&&!n||(o=n||this.genUId(),window.localStorage.setItem(r,o)),o},g.prototype.sign=function(e){var t,n,r,o=Math.abs(parseInt((new Date).getTime()*Math.random()*1e4)).toString(),i=0;for(t=0;t<o.length;t++)i+=parseInt(o[t]);return r=[],n=function(e,t){return t-""+e.length<=0?e:(r[t]||(r[t]=Array(t+1).join(0)))+e},i+=o.length,i=n(i,3-i.toString().length),e.toString()+o+i},g.prototype.object2param=function(e){var t=[];for(var n in e)n&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")},g.prototype.send=function(e,t){var n,r=this,o=r.getURLParams("_")||{},i=JSON.parse(localStorage.getItem("MC_G_ABP")||"{}")||{},a=[],s=r.getPlatform()||"",c="MCH5Perf";if(!o._deviceId&&i._deviceId&&(o=i),delete o._r,delete o._v,o._platform=s,o._appName=o._appName||"",o._appUser=o._appUser||r.setAppUser("_appUser"),o._deviceId=o._deviceId||r.setAppUser("_deviceId"),o._productCategory=c,o._product=o._product||c,o._r=r.sign(1),n=r.object2param(o),a={group:c,event:c+"_"+t,timestamp:(new Date).getTime(),properties:e||{}},p)return r.sendByApp(a);r.ajax({method:"post",data:JSON.stringify([a]),url:"https://oort-shipper.kakamobi.cn/api/h5/receiver/send.htm?"+n,dataType:"json",async:!0,success:function(e){},error:function(){}})},g.prototype.execApp=function(e,t,n,r){try{var o=function(){return p||window.MCProtocolIosExecute||window.MCProtocolAndroidExecute||window.mcAndroidWebview1||window.getMucangIOSWebViewData?navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("iPad")>-1?"iphone":navigator.userAgent.indexOf("Android")>-1?"android":"ipad":"other"},i=function(e,t,n){return t?"https://"+e.toLowerCase()+".luban.mucang.cn/"+t.toLowerCase()+"/"+n:"https://"+e.toLowerCase()+".luban.mucang.cn/"+n},a=function(e){var t,n,r=[];for(t in e)n=typeof e[t],"string"===n||"number"===n?r.push(t+"="+encodeURIComponent(e[t])):r.push(t+"="+encodeURIComponent(JSON.stringify(e[t])));return r},s=function(e){var t,n=[];if(e){for(t in e)switch(t){case"config":n=n.concat(a(e[t]));break;case"callback":case"callbackName":break;default:"object"==typeof e[t]?n.push(t+"="+encodeURIComponent(JSON.stringify(e[t]))):n.push(t+"="+encodeURIComponent(e[t]))}return n.join("&")}return""},c=function(e){var t;if(e)for(t in e)if("callbackName"===t)return e[t];return null},d=function(e){var t;if(e)for(t in e)if("callback"===t)return e[t];return null},u=function(e,t,n,r){return window.MCProtocolIosExecute?window.MCProtocolIosExecute(e+(t?"?"+t:""),g(n,r)):window.getMucangIOSWebViewData(e+(t?"?"+t:""),g(n,r))},l=function(e,t,n,r){return window.MCProtocolAndroidExecute?window.MCProtocolAndroidExecute.exec(e+(t?"?"+t:""),g(n,r)||"NULL"):window.mcAndroidWebview1&&window.mcAndroidWebview1.getMucangWebViewData(e+(t?"?"+t:""),g(n,r)||"NULL")},g=function(e,t){return null},m=i(e,t,n,r),f=s(r),h=d(r),w=c(r);switch(o()){case"iphone":return u(m,f,h,w);case"android":return l(m,f,h,w);default:g(h,w)}}catch(e){console.log("execApp err",e)}},g.prototype.sendByApp=function(e){var t=this;t.execApp("Core","System","stat",{eventId:e.group,eventName:e.event,eventLabel:e.event,properties:e.properties,needCommon:e.needCommon||1})},g.prototype.ajax=function(e){function t(){if(200===n.status)try{e.success(JSON.parse(n.responseText))}catch(e){console.log(e)}else e.error(n.status,n.statusText)}var n=new XMLHttpRequest;"object"==typeof e.data&&!1!==e.contentType&&(e.data=this.object2param(e.data)),"get"===e.method&&(e.url=-1===e.url.indexOf("?")?e.url+"?"+e.data:e.url+"&"+e.data),!0===e.async&&(n.onreadystatechange=function(){4===n.readyState&&t()}),n.open(e.method,e.url,!0),n.withCredentials=!0,!1!==e.contentType&&n.setRequestHeader("Content-Type",e.contentType||"application/x-www-form-urlencoded"),"post"===e.method?n.send(e.data):n.send(null),!1===e.async&&t()},m.prototype.init=function(){var e=this,t={a:navigator.userAgent,b:encodeURIComponent(i.href),c:+new Date};window.addEventListener("error",function(n){var r=["Script error.","ResizeObserver loop limit exceeded","ResizeObserver loop completed with undelivered notifications."];n=n||{},n.message=n.message||"",o--<0||!n.message||-1!==r.indexOf(n.message)||n.source&&-1!==n.source.indexOf("chrome-extension://")?console.log("此种错误过滤掉"):e.send({type:"onerror",data:{message:n.message||"",source:encodeURIComponent(n.filename||""),lineno:n.lineno||"",colno:n.colno||"",error:n.error,client:t}})}),window.addEventListener("unhandledrejection",function(n){o-- >0&&e.send({type:"unhandledrejection",data:{message:n.reason||"",client:t}})})},m.prototype.send=function(t){var n=function(e){var t,n,r="";for(t in e=e||{},e)n=e[t]||"",r+=encodeURIComponent("object"==typeof n?JSON.stringify(n):n);return r};if(this.errIdsSended=this.errIdsSended||[],t=t||{},t.data=t.data||{},t.data.message=JSON.stringify(t.data.message||""),t.data.v=e,t.data.message.length>r&&(t.data.message=t.data.message.slice(0,r)+"..."),this.curErrId=n(t.data),this.curErrId&&-1!==this.errIdsSended.indexOf(this.curErrId))return!1;this.curErrId&&this.errIdsSended.push(this.curErrId),window.MCPerf.send({strs:{id:d,page:c,type:JSON.stringify([t.type||""]),error:JSON.stringify([t.data||""])}},"error")},c.match(s)&&(window.MCPerf=new g,new m)})();